### IMPORTANT UTILITIES ###

# git
alias g='git'
alias ga='git add'
alias gap='git add -p'
alias gb='git checkout -B'
alias gc='git commit'
alias gca='git commit -a'
alias gcam='git commit -am'
alias gcl='git clone'
alias gcm='git commit -m'
alias gco='git checkout'
alias gd='git diff'
alias gds='git diff --staged'
alias gl='git log --graph --full-history --color --oneline --branches --remotes --tags'
alias gla='git log --graph --decorate $(git rev-list -g --branches --remotes --tags)'
alias gp='git push'
alias gpl='git pull'
alias gplr='git pull --rebase'
alias grb='git rebase'
alias gre='git reset'
alias grs='git reset'
alias grsh='git reset HEAD'
alias grsh~='git reset HEAD~'
alias gs='git status'
alias gsh='git show'

alias gitc='git_commit_select'
alias gitd='git_commit_browse'
alias gith='git_history_browse'

git_commit_browse() {
  local out=$(git log --oneline --color | fzf --ansi --multi --reverse)
  local sha=$(awk '{ print $1 }' <<< "$out")
  [ -n "$sha" ] && git show "$sha"
}

git_commit_select() {
  local out=$(git log --oneline --color | fzf --ansi --multi --reverse)
  local sha=$(awk '{ print $1 }' <<< "$out")
  echo "$sha"
}

git_history_browse() {
  local out sha q
  while out=$(
      git log --graph --color=always \
          --format="%C(auto)%h%d %s %C(black)%C(bold)%cr" |
      fzf --ansi --multi --reverse --query="$q" --print-query); do
    q=$(head -1 <<< "$out")
    while read sha; do
      [ -n "$sha" ] && git show --color=always $sha | less -R
    done < <(sed '1d;s/^[^a-z0-9]*//;/^$/d' <<< "$out" | awk '{print $1}')
  done
}

# python
alias py="python3"

# rsync
alias rsync="rsync -h"
alias rscp="rsync -a --info=progress2 --partial"

# vim
alias v='nvim'
alias vim='nvim'
alias vimprivate='vim -u NONE -c "setlocal history=0 nobackup nomodeline noshelltemp noswapfile noundofile nowritebackup secure viminfo=\"\""'
